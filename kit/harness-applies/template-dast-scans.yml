template:
  name: "DAST Scans"
  identifier: "DAST_Scans"
  versionLabel: "1.0"
  type: Stage
  projectIdentifier: instruqt2
  orgIdentifier: default
  spec:
    type: SecurityTests
    spec:
      cloneCodebase: true
      platform:
        os: Linux
        arch: Amd64
      runtime:
        type: Cloud
        spec: {}
      execution:
        steps:
          - parallel:
              - step:
                  type: Zap
                  name: ZAP
                  identifier: ZAP
                  spec:
                    mode: ingestion
                    config: default
                    target:
                      type: instance
                      detection: manual
                      name: frontend
                      variant: main
                    advanced:
                      log:
                        level: info
                    ingestion:
                      file: automation/sto_test/scan_tools/zap/001
              - step:
                  type: Security
                  name: Veracode
                  identifier: Veracode
                  spec:
                    privileged: true
                    settings:
                      product_name: veracode
                      product_config_name: default
                      policy_type: ingestionOnly
                      scan_type: repository
                      repository_project: jhttp_isolated
                      repository_branch: <+codebase.branch>
                      customer_artifacts_path: automation/sto_test/scan_tools/veracode
                      manual_upload_filename: "001"
                    imagePullPolicy: Always
                  failureStrategies:
                    - onFailure:
                        errors:
                          - AllErrors
                        action:
                          type: Ignore
                  when:
                    stageStatus: Success
                    condition: "false"
      sharedPaths:
        - /var/run
      slsa_provenance:
        enabled: false
